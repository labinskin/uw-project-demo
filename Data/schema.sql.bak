

CREATE TABLE Offenses (
	Offense_ID bigint NOT NULL,
    County varchar NOT NULL,
    Agency_Name varchar NOT NULL,
    Offense_Description varchar NOT NULL,
    Min_months_submitted bigint NOT NULL,
    Year bigint NOT NULL,
    Offense_Count bigint NOT NULL,
	PRIMARY KEY (Offense_ID)
);

CREATE TABLE Unemployment (
    State varchar   NOT NULL,
    County varchar   NOT NULL,
    UE_Rural_urban_continuum_code_2013 bigint   NOT NULL,
    UE_Urban_influence_code_2013 bigint   NOT NULL,
    UE_Metro_2013 bigint   NOT NULL,
    UE_Civilian_labor_force_2000 bigint   NOT NULL,
    UE_Employed_2000 bigint   NOT NULL,
    UE_Unemployed_2000 bigint   NOT NULL,
    UE_Unemployment_rate_2000 decimal   NOT NULL,
    UE_Civilian_labor_force_2001 bigint   NOT NULL,
    UE_Employed_2001 bigint   NOT NULL,
    UE_Unemployed_2001 bigint   NOT NULL,
    UE_Unemployment_rate_2001 decimal   NOT NULL,
    UE_Civilian_labor_force_2002 bigint   NOT NULL,
    UE_Employed_2002 bigint   NOT NULL,
    UE_Unemployed_2002 bigint   NOT NULL,
    UE_Unemployment_rate_2002 decimal   NOT NULL,
    UE_Civilian_labor_force_2003 bigint   NOT NULL,
    UE_Employed_2003 bigint   NOT NULL,
    UE_Unemployed_2003 bigint   NOT NULL,
    UE_Unemployment_rate_2003 decimal   NOT NULL,
    UE_Civilian_labor_force_2004 bigint   NOT NULL,
    UE_Employed_2004 bigint   NOT NULL,
    UE_Unemployed_2004 bigint   NOT NULL,
    UE_Unemployment_rate_2004 decimal   NOT NULL,
    UE_Civilian_labor_force_2005 bigint   NOT NULL,
    UE_Employed_2005 bigint   NOT NULL,
    UE_Unemployed_2005 bigint   NOT NULL,
    UE_Unemployment_rate_2005 decimal   NOT NULL,
    UE_Civilian_labor_force_2006 bigint   NOT NULL,
    UE_Employed_2006 bigint   NOT NULL,
    UE_Unemployed_2006 bigint   NOT NULL,
    UE_Unemployment_rate_2006 decimal   NOT NULL,
    UE_Civilian_labor_force_2007 bigint   NOT NULL,
    UE_Employed_2007 bigint   NOT NULL,
    UE_Unemployed_2007 bigint   NOT NULL,
    UE_Unemployment_rate_2007 decimal   NOT NULL,
    UE_Civilian_labor_force_2008 bigint   NOT NULL,
    UE_Employed_2008 bigint   NOT NULL,
    UE_Unemployed_2008 bigint   NOT NULL,
    UE_Unemployment_rate_2008 decimal   NOT NULL,
    UE_Civilian_labor_force_2009 bigint   NOT NULL,
    UE_Employed_2009 bigint   NOT NULL,
    UE_Unemployed_2009 bigint   NOT NULL,
    UE_Unemployment_rate_2009 decimal   NOT NULL,
    UE_Civilian_labor_force_2010 bigint   NOT NULL,
    UE_Employed_2010 bigint   NOT NULL,
    UE_Unemployed_2010 bigint   NOT NULL,
    UE_Unemployment_rate_2010 decimal   NOT NULL,
    UE_Civilian_labor_force_2011 bigint   NOT NULL,
    UE_Employed_2011 bigint   NOT NULL,
    UE_Unemployed_2011 bigint   NOT NULL,
    UE_Unemployment_rate_2011 decimal   NOT NULL,
    UE_Civilian_labor_force_2012 bigint   NOT NULL,
    UE_Employed_2012 bigint   NOT NULL,
    UE_Unemployed_2012 bigint   NOT NULL,
    UE_Unemployment_rate_2012 decimal   NOT NULL,
    UE_Civilian_labor_force_2013 bigint   NOT NULL,
    UE_Employed_2013 bigint   NOT NULL,
    UE_Unemployed_2013 bigint   NOT NULL,
    UE_Unemployment_rate_2013 decimal   NOT NULL,
    UE_Civilian_labor_force_2014 bigint   NOT NULL,
    UE_Employed_2014 bigint   NOT NULL,
    UE_Unemployed_2014 bigint   NOT NULL,
    UE_Unemployment_rate_2014 decimal   NOT NULL,
    UE_Civilian_labor_force_2015 bigint   NOT NULL,
    UE_Employed_2015 bigint   NOT NULL,
    UE_Unemployed_2015 bigint   NOT NULL,
    UE_Unemployment_rate_2015 decimal   NOT NULL,
    UE_Civilian_labor_force_2016 bigint   NOT NULL,
    UE_Employed_2016 bigint   NOT NULL,
    UE_Unemployed_2016 bigint   NOT NULL,
    UE_Unemployment_rate_2016 decimal   NOT NULL,
    UE_Civilian_labor_force_2017 bigint   NOT NULL,
    UE_Employed_2017 bigint   NOT NULL,
    UE_Unemployed_2017 bigint   NOT NULL,
    UE_Unemployment_rate_2017 decimal   NOT NULL,
    UE_Civilian_labor_force_2018 bigint   NOT NULL,
    UE_Employed_2018 bigint   NOT NULL,
    UE_Unemployed_2018 bigint   NOT NULL,
    UE_Unemployment_rate_2018 decimal   NOT NULL,
    UE_Civilian_labor_force_2019 bigint   NOT NULL,
    UE_Employed_2019 bigint   NOT NULL,
    UE_Unemployed_2019 bigint   NOT NULL,
    UE_Unemployment_rate_2019 decimal   NOT NULL,
    UE_Civilian_labor_force_2020 bigint   NOT NULL,
    UE_Employed_2020 bigint   NOT NULL,
    UE_Unemployed_2020 bigint   NOT NULL,
    UE_Unemployment_rate_2020 decimal   NOT NULL,
    UE_Median_Household_Income_2019 bigint   NOT NULL,
    UE_Med_HH_Income_Percent_of_State_Total_2019 decimal   NOT NULL,
	PRIMARY KEY (County)
);

CREATE TABLE Alcohol_Consumption (
    State varchar   NOT NULL,
    County varchar   NOT NULL,
    AC_Both_Sexes_2002 decimal   NOT NULL,
    AC_Females_2002 decimal   NOT NULL,
    AC_Males_2002 decimal   NOT NULL,
    AC_Both_Sexes_2003 decimal   NOT NULL,
    AC_Females_2003 decimal   NOT NULL,
    AC_Males_2003 decimal   NOT NULL,
    AC_Both_Sexes_2004 decimal   NOT NULL,
    AC_Females_2004 decimal   NOT NULL,
    AC_Males_2004 decimal   NOT NULL,
    AC_Both_Sexes_2005 decimal   NOT NULL,
    AC_Females_2005 decimal   NOT NULL,
    AC_Males_2005 decimal   NOT NULL,
    AC_Both_Sexes_2006 decimal   NOT NULL,
    AC_Females_2006 decimal   NOT NULL,
    AC_Males_2006 decimal   NOT NULL,
    AC_Both_Sexes_2007 decimal   NOT NULL,
    AC_Females_2007 decimal   NOT NULL,
    AC_Males_2007 decimal   NOT NULL,
    AC_Both_Sexes_2008 decimal   NOT NULL,
    AC_Females_2008 decimal   NOT NULL,
    AC_Males_2008 decimal   NOT NULL,
    AC_Both_Sexes_2009 decimal   NOT NULL,
    AC_Females_2009 decimal   NOT NULL,
    AC_Males_2009 decimal   NOT NULL,
    AC_Both_Sexes_2010 decimal   NOT NULL,
    AC_Females_2010 decimal   NOT NULL,
    AC_Males_2010 decimal   NOT NULL,
    AC_Both_Sexes_2011 decimal   NOT NULL,
    AC_Females_2011 decimal   NOT NULL,
    AC_Males_2011 decimal   NOT NULL,
    AC_Both_Sexes_2012 decimal   NOT NULL,
    AC_Females_2012 decimal   NOT NULL,
    AC_Males_2012 decimal   NOT NULL,
    AC_Percent_Change_2002_2012_Both_Sexes decimal   NOT NULL,
    AC_Percent_Change_2002_2012_Females decimal   NOT NULL,
    AC_Percent_Change_2002_2012_Males decimal   NOT NULL,
    AC_Percent_Change_2005_2012_Both_Sexes decimal   NOT NULL,
    AC_Percent_Change_2005_2012_Females decimal   NOT NULL,
    AC_Percent_Change_2005_2012_Males decimal   NOT NULL, 
	PRIMARY KEY (County)
);

CREATE TABLE Binge_Drinking (
    State varchar   NOT NULL,
    County varchar   NOT NULL,
    Both_Sexes_2002 decimal   NOT NULL,
    Females_2002 decimal   NOT NULL,
    Males_2002 decimal   NOT NULL,
    Both_Sexes_2003 decimal   NOT NULL,
    Females_2003 decimal   NOT NULL,
    Males_2003 decimal   NOT NULL,
    Both_Sexes_2004 decimal   NOT NULL,
    Females_2004 decimal   NOT NULL,
    Males_2004 decimal   NOT NULL,
    Both_Sexes_2005 decimal   NOT NULL,
    Females_2005 decimal   NOT NULL,
    Males_2005 decimal   NOT NULL,
    Both_Sexes_2006 decimal   NOT NULL,
    Females_2006 decimal   NOT NULL,
    Males_2006 decimal   NOT NULL,
    Both_Sexes_2007 decimal   NOT NULL,
    Females_2007 decimal   NOT NULL,
    Males_2007 decimal   NOT NULL,
    Both_Sexes_2008 decimal   NOT NULL,
    Females_2008 decimal   NOT NULL,
    Males_2008 decimal   NOT NULL,
    Both_Sexes_2009 decimal   NOT NULL,
    Females_2009 decimal   NOT NULL,
    Males_2009 decimal   NOT NULL,
    Both_Sexes_2010 decimal   NOT NULL,
    Females_2010 decimal   NOT NULL,
    Males_2010 decimal   NOT NULL,
    Both_Sexes_2011 decimal   NOT NULL,
    Females_2011 decimal   NOT NULL,
    Males_2011 decimal   NOT NULL,
    Both_Sexes_2012 decimal   NOT NULL,
    Females_2012 decimal   NOT NULL,
    Males_2012 decimal   NOT NULL,
    Percent_Change_2002_2012_Both_Sexes decimal   NOT NULL,
    Percent_Change_2002_2012_Females decimal   NOT NULL,
    Percent_Change_2002_2012_Males decimal   NOT NULL,
    Percent_Change_2005_2012_Both_Sexes decimal   NOT NULL,
    Percent_Change_2005_2012_Females decimal   NOT NULL,
    Percent_Change_2005_2012_Males decimal   NOT NULL, 
	FOREIGN KEY (County) REFERENCES Alcohol_Consumption (County),
	PRIMARY KEY (County)
);

CREATE TABLE Heavy_Drinking (
    State varchar   NOT NULL,
    County varchar   NOT NULL,
    HD_Both_Sexes_2005 decimal   NOT NULL,
    HD_Females_2005 decimal   NOT NULL,
    HD_Males_2005 decimal   NOT NULL,
    HD_Both_Sexes_2006 decimal   NOT NULL,
    HD_Females_2006 decimal   NOT NULL,
    HD_Males_2006 decimal   NOT NULL,
    HD_Both_Sexes_2007 decimal   NOT NULL,
    HD_Females_2007 decimal   NOT NULL,
    HD_Males_2007 decimal   NOT NULL,
    HD_Both_Sexes_2008 decimal   NOT NULL,
    HD_Females_2008 decimal   NOT NULL,
    HD_Males_2008 decimal   NOT NULL,
    HD_Both_Sexes_2009 decimal   NOT NULL,
    HD_Females_2009 decimal   NOT NULL,
    HD_Males_2009 decimal   NOT NULL,
    HD_Both_Sexes_2010 decimal   NOT NULL,
    HD_Females_2010 decimal   NOT NULL,
    HD_Males_2010 decimal   NOT NULL,
    HD_Both_Sexes_2011 decimal   NOT NULL,
    HD_Females_2011 decimal   NOT NULL,
    HD_Males_2011 decimal   NOT NULL,
    HD_Both_Sexes_2012 decimal   NOT NULL,
    HD_Females_2012 decimal   NOT NULL,
    HD_Males_2012 decimal   NOT NULL,
    HD_Percent_Change_2005_2012_Both_Sexes decimal   NOT NULL,
    HD_Percent_Change_2005_2012_Females decimal   NOT NULL,
    HD_Percent_Change_2005_2012_Males decimal   NOT NULL,
	FOREIGN KEY (County) REFERENCES Alcohol_Consumption (County),
	PRIMARY KEY (County)
);

CREATE TABLE Prop_Binge_Drinking (
    State varchar   NOT NULL,
    County varchar   NOT NULL,
    BD_Both_Sexes_2002 decimal   NOT NULL,
    BD_Females_2002 decimal   NOT NULL,
    BD_Males_2002 decimal   NOT NULL,
    BD_Both_Sexes_2003 decimal   NOT NULL,
    BD_Females_2003 decimal   NOT NULL,
    BD_Males_2003 decimal   NOT NULL,
    BD_Both_Sexes_2004 decimal   NOT NULL,
    BD_Females_2004 decimal   NOT NULL,
    BD_Males_2004 decimal   NOT NULL,
    BD_Both_Sexes_2005 decimal   NOT NULL,
    BD_Females_2005 decimal   NOT NULL,
    BD_Males_2005 decimal   NOT NULL,
    BD_Both_Sexes_2006 decimal   NOT NULL,
    BD_Females_2006 decimal   NOT NULL,
    BD_Males_2006 decimal   NOT NULL,
    BD_Both_Sexes_2007 decimal   NOT NULL,
    BD_Females_2007 decimal   NOT NULL,
    BD_Males_2007 decimal   NOT NULL,
    BD_Both_Sexes_2008 decimal   NOT NULL,
    BD_Females_2008 decimal   NOT NULL,
    BD_Males_2008 decimal   NOT NULL,
    BD_Both_Sexes_2009 decimal   NOT NULL,
    BD_Females_2009 decimal   NOT NULL,
    BD_Males_2009 decimal   NOT NULL,
    BD_Both_Sexes_2010 decimal   NOT NULL,
    BD_Females_2010 decimal   NOT NULL,
    BD_Males_2010 decimal   NOT NULL,
    BD_Both_Sexes_2011 decimal   NOT NULL,
    BD_Females_2011 decimal   NOT NULL,
    BD_Males_2011 decimal   NOT NULL,
    BD_Both_Sexes_2012 decimal   NOT NULL,
    BD_Females_2012 decimal   NOT NULL,
    BD_Males_2012 decimal   NOT NULL,
    BD_Percent_Change_2002_2012_Both_Sexes decimal   NOT NULL,
    BD_Percent_Change_2002_2012_Females decimal   NOT NULL,
    BD_Percent_Change_2002_2012_Males decimal   NOT NULL,
    BD_Percent_Change_2005_2012_Both_Sexes decimal   NOT NULL,
    BD_Percent_Change_2005_2012_Females decimal   NOT NULL,
    BD_Percent_Change_2005_2012_Males decimal   NOT NULL,
	FOREIGN KEY (County) REFERENCES Alcohol_Consumption (County),
	PRIMARY KEY (County)
);

CREATE TABLE Poverty (
    Stabr varchar   NOT NULL,
    County varchar   NOT NULL,
    POV_Rural_urban_Continuum_Code_2003 bigint   NOT NULL,
    POV_Urban_Influence_Code_2003 bigint   NOT NULL,
    POV_Rural_urban_Continuum_Code_2013 bigint   NOT NULL,
    POV_Urban_Influence_Code_2013 bigint   NOT NULL,
    POV_POVALL_2019 bigint   NOT NULL,
    POV_CI90LBALL_2019 bigint   NOT NULL,
    POV_CI90UBALL_2019 bigint   NOT NULL,
    POV_PCTPOVALL_2019 decimal   NOT NULL,
    POV_CI90LBALLP_2019 decimal   NOT NULL,
    POV_CI90UBALLP_2019 decimal   NOT NULL,
    POV_POV017_2019 bigint   NOT NULL,
    POV_CI90LB017_2019 bigint   NOT NULL,
    POV_CI90UB017_2019 bigint   NOT NULL,
    POV_PCTPOV017_2019 decimal   NOT NULL,
    POV_CI90LB017P_2019 decimal   NOT NULL,
    POV_CI90UB017P_2019 decimal   NOT NULL,
    POV_POV517_2019 bigint   NOT NULL,
    POV_CI90LB517_2019 bigint   NOT NULL,
    POV_CI90UB517_2019 bigint   NOT NULL,
    POV_PCTPOV517_2019 decimal   NOT NULL,
    POV_CI90LB517P_2019 decimal   NOT NULL,
    POV_CI90UB517P_2019 decimal   NOT NULL,
    POV_MEDHHINC_2019 bigint   NOT NULL,
    POV_CI90LBINC_2019 bigint   NOT NULL,
    POV_CI90UBINC_2019 bigint   NOT NULL,
	PRIMARY KEY (County)
);

CREATE TABLE GDP (
    County varchar   NOT NULL,
    Real_GDP_2017 bigint   NOT NULL,
    Real_GDP_2018 bigint   NOT NULL,
    Real_GDP_2019 bigint   NOT NULL,
    Real_GDP_2020 bigint   NOT NULL,
    Rank_in_State_2020 bigint   NOT NULL,
    GDP_Percent_change_2018 decimal   NOT NULL,
    GDP_Percent_change_2019 decimal   NOT NULL,
    GDP_Percent_change2020 decimal   NOT NULL,
    GDP_Change_Rank_in_State_2020 bigint   NOT NULL,
	FOREIGN KEY (County) REFERENCES Poverty (County),
	PRIMARY KEY (County)
);

CREATE TABLE Population (
    State varchar   NOT NULL,
    County varchar   NOT NULL,
    Population_1990 bigint   NOT NULL,
    Population_2000 bigint   NOT NULL,
    Population_2010 bigint   NOT NULL,
    Population_2020 bigint   NOT NULL,
	FOREIGN KEY (County) REFERENCES GDP (County),
	PRIMARY KEY (County)
);

CREATE TABLE Education (
    State varchar   NOT NULL,
    County varchar   NOT NULL,
    Rural_urban_Continuum_Code_2003 bigint   NOT NULL,
    Urban_Influence_Code_2003 bigint   NOT NULL,
    Rural_urban_Continuum_Code_2013 bigint   NOT NULL,
    Urban_Influence_Code_2013 bigint   NOT NULL,
    Less_than_a_high_school_diploma_1970 bigint   NOT NULL,
    High_school_diploma_only_1970 bigint   NOT NULL,
    Some_college_1970 bigint   NOT NULL,
    Four_years_of_college_or_higher_1970 bigint   NOT NULL,
    Percent_less_than_a_high_school_diploma_1970 decimal   NOT NULL,
    Percent_high_school_diploma_only_1970 decimal   NOT NULL,
    Percent_some_college_1970 decimal   NOT NULL,
    Percent_bachelors_degree_or_higher_1970 decimal   NOT NULL,
    Less_than_a_high_school_diploma_1980 bigint   NOT NULL,
    High_school_diploma_only_1980 bigint   NOT NULL,
    Some_college_1980 bigint   NOT NULL,
    Four_years_of_college_or_higher_1980 bigint   NOT NULL,
    Percent_less_than_a_high_school_diploma_1980 decimal   NOT NULL,
    Percent_high_school_diploma_only_1980 decimal   NOT NULL,
    Percent_some_college_1980 decimal   NOT NULL,
    Percent_bachelors_degree_or_higher_1980 decimal   NOT NULL,
    Less_than_a_high_school_diploma_1990 bigint   NOT NULL,
    High_school_diploma_only_1990 bigint   NOT NULL,
    Some_college_or_associates_degree_1990 bigint   NOT NULL,
    Bachelors_degree_or_higher_1990 bigint   NOT NULL,
    Percent_less_than_a_high_school_diploma_1990 decimal   NOT NULL,
    Percent_high_school_diploma_only_1990 decimal   NOT NULL,
    Percent_some_college_or_associates_degree_1990 decimal   NOT NULL,
    Percent_bachelors_degree_or_higher_1990 decimal   NOT NULL,
    Less_than_a_high_school_diploma_2000 bigint   NOT NULL,
    High_school_diploma_only_2000 bigint   NOT NULL,
    Some_college_or_associates_degree_2000 bigint   NOT NULL,
    Bachelors_degree_or_higher_2000 bigint   NOT NULL,
    Percent_less_than_a_high_school_diploma_2000 decimal   NOT NULL,
    Percent_high_school_diploma_only_2000 decimal   NOT NULL,
    Percent_some_college_or_associates_degree_2000 decimal   NOT NULL,
    Percent_bachelors_degree_or_higher_2000 decimal   NOT NULL,
    Less_than_a_high_school_diploma_2015_19 bigint   NOT NULL,
    High_school_diploma_only_2015_19 bigint   NOT NULL,
    Some_college_or_associates_degree_2015_19 bigint   NOT NULL,
    Bachelors_degree_or_higher_2015_19 bigint   NOT NULL,
    Percent_less_than_a_high_school_diploma_2015_19 decimal   NOT NULL,
    Percent_high_school_diploma_only_2015_19 decimal   NOT NULL,
    Percent_some_college_or_associates_degree_2015_19 decimal   NOT NULL,
    Percent_bachelors_degree_or_higher_2015_19 decimal   NOT NULL,
	PRIMARY KEY (County)
);

CREATE TABLE counties (
    County varchar NOT NULL,
	State varchar NOT NULL,
	PRIMARY KEY (County));
	
CREATE VIEW offenses_by_county_over_year
AS 
SELECT counties.county, offense_description, year, SUM(offense_count) AS sum_offense_count FROM counties INNER JOIN offenses ON counties.county = offenses.county
GROUP BY counties.county, offense_description, year 
ORDER BY counties.county, offense_description, year DESC;

SELECT * FROM offenses_by_county_over_year;
